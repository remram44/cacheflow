(function(t){function e(e){for(var o,i,a=e[0],c=e[1],u=e[2],l=0,f=[];l<a.length;l++)i=a[l],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&f.push(r[i][0]),r[i]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(t[o]=c[o]);p&&p(e);while(f.length)f.shift()();return s.push.apply(s,u||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],o=!0,a=1;a<n.length;a++){var c=n[a];0!==r[c]&&(o=!1)}o&&(s.splice(e--,1),t=i(i.s=n[0]))}return t}var o={},r={app:0},s=[];function i(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=o,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/cacheflow/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=e,a=a.slice();for(var u=0;u<a.length;u++)e(a[u]);var p=c;s.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";var o=n("85ec"),r=n.n(o);r.a},1705:function(t,e,n){},"18d3":function(t,e,n){"use strict";var o=n("1705"),r=n.n(o);r.a},3402:function(t,e,n){"use strict";var o=n("737f"),r=n.n(o);r.a},4607:function(t,e,n){"use strict";var o=n("b876"),r=n.n(o);r.a},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("Canvas",{attrs:{workflow:t.workflow},on:{stepremove:t.removeStep,stepmove:t.moveStep}}),n("Library",{on:{add:t.addStep}})],1)},s=[],i=(n("a4d3"),n("e01a"),n("d28b"),n("a434"),n("b0c0"),n("d3b7"),n("3ca3"),n("ddb0"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"canvas"},t._l(t.workflow.steps,(function(e,o){return n("Step",{key:o,attrs:{step:e,name:o},on:{setport:t.setPort,stepmove:t.moveStep,remove:function(e){return t.removeStep(o)}}})})),1),n("svg",{staticClass:"canvas ports"},t._l(this.ports,(function(t){return n("Port",{key:t.name,attrs:{port:t}})})),1),n("svg",{staticClass:"canvas connections"},t._l(t.connections,(function(t){return n("Connection",{key:t.key,attrs:{connection:t.data}})})),1)])}),a=[],c=(n("99af"),n("4fad"),n("3835")),u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"step",style:t.style,on:{mousedown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"left",37,e.key,["Left","ArrowLeft"])?null:"button"in e&&0!==e.button?null:e.target!==e.currentTarget?null:(e.preventDefault(),t.mousedown(e))}}},[n("a",{staticClass:"close",on:{click:function(e){return e.target!==e.currentTarget?null:(e.preventDefault(),t.remove(e))}}},[t._v("[x]")]),n("h2",[t._v(t._s(t.step.component.type))]),n("table",{staticClass:"outputs"},t._l(t.step.outputs,(function(e){return n("tr",{key:e},[n("td",[t._v("???")]),n("td",[t._v(t._s(e))])])})),0),n("table",{staticClass:"inputs"},t._l(t.inputs,(function(e){return n("tr",{key:e[0]},[n("td",[t._v(t._s(e[0]))]),n("td",[null!==e[1]?n("input",{attrs:{type:"text"},domProps:{value:e[1]}}):t._e()])])})),0)])},p=[];n("4e82"),n("ac1f"),n("25f0"),n("5319");function l(t,e){t.sort((function(t,n){return e(t)<e(n)?-1:e(t)>e(n)?1:0}))}function f(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0,n="x"==t?e:3&e|8;return n.toString(16)}))}var v={name:"Step",props:["name","step"],computed:{inputs:function(){var t=Object.entries(this.step.inputs);l(t,(function(t){return t[0]}));for(var e=0;e<t.length;++e)0==t[e][1].length?t[e][1]="":"string"!=typeof t[e][1][0]&&(t[e][1]=null);return t},style:function(){return"left: ".concat(this.step.position[0],"px; top: ").concat(this.step.position[1],"px;")}},methods:{sendUpdate:function(){for(var t=this.$el.querySelectorAll(".outputs tr"),e=0;e<t.length;++e){var n=t[e].getBoundingClientRect();this.$emit("setport",{name:"".concat(this.name,".out.").concat(this.step.outputs[e]),type:"output",position:[n.right+6,(n.top+n.bottom)/2]})}for(var o=this.$el.querySelectorAll(".inputs tr"),r=0;r<o.length;++r){var s=o[r].getBoundingClientRect();this.$emit("setport",{name:"".concat(this.name,".in.").concat(this.inputs[r][0]),type:"input",position:[s.left-6,(s.top+s.bottom)/2]})}},mousedown:function(t){console.log("grabbed step ",this.name),document.addEventListener("mouseup",this.mouseup),document.addEventListener("mousemove",this.mousemove),this.offset=[this.step.position[0]-t.clientX,this.step.position[1]-t.clientY]},mouseup:function(){console.log("dropped step ",this.name),document.removeEventListener("mouseup",this.mouseup),document.removeEventListener("mousemove",this.mousemove),this.$emit("stepmove",{name:this.name,position:this.step.position})},mousemove:function(t){t.preventDefault(),this.step.position=[t.clientX+this.offset[0],t.clientY+this.offset[1]]},remove:function(){this.$emit("remove")}},mounted:function(){this.$nextTick(this.sendUpdate)},updated:function(){this.$nextTick(this.sendUpdate)},beforeDestroy:function(){document.removeEventListener("mousemove",this.mousemoved),document.removeEventListener("mouseup",this.mouseup);var t=!0,e=!1,n=void 0;try{for(var o,r=this.step.outputs[Symbol.iterator]();!(t=(o=r.next()).done);t=!0){var s=o.value;this.$emit("setport",{name:"".concat(this.name,".out.").concat(s),position:void 0})}}catch(f){e=!0,n=f}finally{try{t||null==r.return||r.return()}finally{if(e)throw n}}var i=!0,a=!1,c=void 0;try{for(var u,p=this.inputs[Symbol.iterator]();!(i=(u=p.next()).done);i=!0){var l=u.value;this.$emit("setport",{name:"".concat(this.name,".in.").concat(l[0]),position:void 0})}}catch(f){a=!0,c=f}finally{try{i||null==p.return||p.return()}finally{if(a)throw c}}}},m=v,d=(n("18d3"),n("2877")),h=Object(d["a"])(m,u,p,!1,null,"51bfc74a",null),y=h.exports,b=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("circle",{class:t.port.type,attrs:{cx:t.port.position[0],cy:t.port.position[1]}})},x=[],w={props:["port"]},g=w,_=(n("f89a"),Object(d["a"])(g,b,x,!1,null,"b549d3fc",null)),k=_.exports,S=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("path",{staticClass:"connection",attrs:{d:t.path}})},$=[],O={props:["connection"],computed:{path:function(){return this.connection}}},j=O,C=(n("3402"),Object(d["a"])(j,S,$,!1,null,"ec509d98",null)),E=C.exports,P={props:["workflow"],data:function(){return{ports:{}}},computed:{connections:function(){var t={},e={},n={};for(var o in this.workflow.steps){var r=this.workflow.steps[o],s=0;t[o]={};var i=!0,a=!1,u=void 0;try{for(var p,f=r.outputs[Symbol.iterator]();!(i=(p=f.next()).done);i=!0){var v=p.value;t[o][v]=s++}}catch(J){a=!0,u=J}finally{try{i||null==f.return||f.return()}finally{if(a)throw u}}e[o]=s;var m=0;n[o]={};var d=Object.entries(r.inputs);l(d,(function(t){return t[0]}));for(var h=0,y=d;h<y.length;h++){var b=Object(c["a"])(y[h],1),x=b[0];n[o][x]=m++}}var w=[];for(var g in this.workflow.steps){var _=this.workflow.steps[g];for(var k in _.inputs){var S=_.inputs[k],$=!0,O=!1,j=void 0;try{for(var C,E=S[Symbol.iterator]();!($=(C=E.next()).done);$=!0){var P=C.value;if("string"!=typeof P){var L=0,T=0,M="".concat(P.step,".out.").concat(P.output);if(M in this.ports){var D=Object(c["a"])(this.ports[M].position,2);L=D[0],T=D[1]}var A=0,U=0,q="".concat(g,".in.").concat(k);if(q in this.ports){var B=Object(c["a"])(this.ports[q].position,2);A=B[0],U=B[1]}w.push({key:"".concat(g,".").concat(k,".").concat(P.step,".").concat(P.output),data:"M ".concat(L," ").concat(T," C ").concat(L+40," ").concat(T," ").concat(A-40," ").concat(U," ").concat(A," ").concat(U)})}}}catch(J){O=!0,j=J}finally{try{$||null==E.return||E.return()}finally{if(O)throw j}}}}return w}},methods:{setPort:function(t){void 0!==t.position?this.$set(this.ports,t.name,t):this.$delete(this.ports,t.name)},moveStep:function(t){this.$emit("stepmove",t)},removeStep:function(t){this.$emit("stepremove",t)}},components:{Step:y,Port:k,Connection:E}},L=P,T=(n("a042"),Object(d["a"])(L,i,a,!1,null,"f7f24532",null)),M=T.exports,D=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"library"},[n("div",[n("div",[n("h1",[t._v("Workflow library")]),t._l(t.components,(function(e){return n("p",{key:e.component.type},[n("button",{on:{click:function(n){return t.add(e)}}},[t._v(t._s(e.name))])])}))],2)])])},A=[],U={data:function(){return{components:[{name:"dataset",component:{type:"dataset"},inputs:["name"],outputs:["table"]},{name:"plot",component:{type:"plot"},inputs:["style","table","x","y"],outputs:["plot"]}]}},methods:{add:function(t){this.$emit("add",t)}}},q=U,B=(n("4607"),Object(d["a"])(q,D,A,!1,null,"241c44be",null)),J=B.exports,R={name:"app",data:function(){return{workflow:{steps:{dataset:{component:{type:"dataset"},position:[100,100],inputs:{name:["age.csv"]},outputs:["table"]},plot:{component:{type:"plot"},position:[350,150],inputs:{table:[{step:"dataset",output:"table"}],x:["name"],y:["age"],style:[]},outputs:["plot"]}}}}},methods:{addStep:function(t){var e={},n=!0,o=!1,r=void 0;try{for(var s,i=t.inputs[Symbol.iterator]();!(n=(s=i.next()).done);n=!0){var a=s.value;e[a]=[]}}catch(u){o=!0,r=u}finally{try{n||null==i.return||i.return()}finally{if(o)throw r}}var c=f();this.$set(this.workflow.steps,c,{component:t.component,position:[10,10],inputs:e,outputs:t.outputs.splice()}),console.log("Step ",c," added")},removeStep:function(t){this.$delete(this.workflow.steps,t),console.log("Step ",t," removed")},moveStep:function(t){var e=t.name,n=t.position;console.log("Step ",e," moved to ",n)}},components:{Canvas:M,Library:J}},X=R,Y=(n("034f"),Object(d["a"])(X,r,s,!1,null,null,null)),W=Y.exports;o["a"].config.productionTip=!1,new o["a"]({render:function(t){return t(W)}}).$mount("#app")},"737f":function(t,e,n){},"85ec":function(t,e,n){},a042:function(t,e,n){"use strict";var o=n("c595"),r=n.n(o);r.a},b876:function(t,e,n){},c595:function(t,e,n){},c5ae:function(t,e,n){},f89a:function(t,e,n){"use strict";var o=n("c5ae"),r=n.n(o);r.a}});
//# sourceMappingURL=app.1cdb6178.js.map